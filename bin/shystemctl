#! /bin/bash
# -*-  Mode: sh; tab-width: 2; indent-tabs-mode: nil; sh-basic-offset: 2; -*-
#
# @file         shystemctl
#
#               Systemctl-style frontend for shystemd commands. The commands
#               themselves (daemon-reload, start, stop, list-units, etc), are
#               stored individual files inside libexec directory.
#
# @author       Wes Garland, wes@kingsds.network
# @date         Feb 2022
#
        
export SHYSTEMD_BIN_DIR=`dirname "${BASH_SOURCE[0]}"`

cd "${SHYSTEMD_BIN_DIR}"/..
. etc/shystemd/default-env.incl
cd "${SHYSTEMD_BIN_DIR}" # cwd is always bin
. "${SHYSTEMD_LIB_DIR}"/locate
. "${SHYSTEMD_LIB_DIR}"/find-make

cmd="$1"; shift
args="$@"
[ ! "$cmd" ] && cmd="list-units"

if [ ! -f "${SHYSTEMD_LIBEXEC_DIR}/$cmd" ]; then
  echo "Unknown operation $cmd" >&2
  exit 1
fi

(. "${SHYSTEMD_LIBEXEC_DIR}/$cmd")
